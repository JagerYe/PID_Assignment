<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<title>Nectaria - Free HTML Template by WowThemes.net</title>
	<meta name="description" content="Thoughts, reviews and ideas since 1999." />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="icon" href="/PID_Assignment/views/img/logo.png">
	<link rel="stylesheet" type="text/css" href="/PID_Assignment/views/css/screen.css" />
	<link rel="stylesheet" type="text/css"
		href="https://fonts.googleapis.com/css?family=Roboto:400,300italic,300,400italic,700,700italic|Playfair+Display:400,700,400italic,700italic" />
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="/PID_Assignment/views/css/list.css">
	<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
		integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
		crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
		integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
		crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
		integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
		crossorigin="anonymous"></script>
</head>
<style>
	ul {
		list-style-type: none;
	}

	.hide {
		display: none;
	}
</style>

<body class="author-template">
	<div class="site-wrapper">
		<nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
			<a class="navbar-brand" href="/PID_Assignment/views/pageBack/commodityList.html">
				<img src="/PID_Assignment/views/img/logo.png" alt="Fashion Critiques" />
			</a>
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse"
				aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarCollapse">
				<ul class="navbar-nav mr-auto">
					<li class="nav-item active">
						<a class="nav-link" href="/PID_Assignment/views/pageBack/commodityList.html">首頁<span
								class="sr-only">(current)</span></a>
					</li>
					<li class="nav-item active">
						<a class="nav-link" href="/PID_Assignment/views/pageBack/commodityList.html">商品管理</a>
					</li>
					<li class="nav-item active">
						<a class="nav-link" href="/PID_Assignment/views/pageBack/memberList.html">會員管理</a>
					</li>
				</ul>
				<span class="socialheader row">
					<div class="col" id="empID">empID</div>
					<a class="col" href="/PID_Assignment/views/pageBack/login.html">登入</a>
				</span>
			</div>
		</nav>
		<br><br><br><br><br><br>

		<ul class="list" id="list">

			<li class="row">
				<div class="col-3"><strong>會員圖片</strong></div>
				<div class="col-2"><strong>帳號</strong></div>
				<div class="col-2"><strong>電話</strong></div>
				<div class="col-2"><strong>名稱</strong></div>
				<div class="col-2"><strong>狀態</strong></div>
				<div class="col-1"><strong>訂單</strong></div>
			</li>
			<!-- 一會員 -->
			<li class="row">
				<div class="col-3">
					<img src="/PID_Assignment/views/img/gravatar.jpg"><br>
				</div>
				<div class="col-2">帳號</div>
				<div class="col-2">電話</div>
				<div class="col-2">名稱</div>
				<div class="col-2">
					<select id="select" name="select" class="custom-select">
						<option value="open">啟用</option>
						<option value="close">停用</option>
					</select>
				</div>
				<div class="col-1">
					<button type="button" name="" id="">過往訂單</button>
				</div>
			</li><br>



		</ul>


	</div>

	<br><br>
	<footer class="site-footer clearfix">
		<a href="#top" id="back-to-top" class="back-top"></a>
		<div class="text-center">
			<a href="index.html">Nectaria Template</a> &copy; 2016<br />
			Free HTML Template by <a href="https://wowthemes.net">WowThemes.net</a>
		</div>
	</footer>
	</div>

</body>
<script type="module">
	import { Member } from "../js/models/member.js";
	import { Order } from "../js/models/order.js";
	import { OrderDetail } from "../js/models/orderDetail.js";

	import { MemberViewModel } from "../js/viewModels/memberViewModel.js";
	import { OrderViewModel } from "../js/viewModels/orderViewModel.js";

	//假資料－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
	var members = [
		new Member("aa", "aa1", "ll@gmail.com", "0911345678", true),
		new Member("bb", "bb1", "bb@gmail.com", "0912345678", true),
		new Member("cc", "cc1", "cc@gmail.com", "0913345678", false),
		new Member("dd", "dd1", "dd@gmail.com", "0914345678", true),
		new Member("ee", "ee1", "ee@gmail.com", "0915345678", false),
		new Member("ff", "ff1", "ff@gmail.com", "0916345678", true)
	];
	var orders = [
		new Order(0, "2020-01-01", false, "aa", 460),
		new Order(1, "2020-01-01", false, "aa", 280),
		new Order(2, "2020-01-01", false, "bb", 500)
	];
	var orderDetails = [
		new OrderDetail(0, "11", 90, 3),
		new OrderDetail(0, "12", 30, 4),
		new OrderDetail(0, "13", 70, 1),
		new OrderDetail(1, "11", 90, 2),
		new OrderDetail(1, "14", 30, 1),
		new OrderDetail(1, "15", 70, 1),
		new OrderDetail(2, "12", 90, 3),
		new OrderDetail(2, "13", 30, 3),
		new OrderDetail(2, "14", 70, 2)
	];
	//假資料－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－

	//更新畫面
	function updateMenu() {
		$("#list").empty();
		$("#list").append(`
			<li class="row">
				<div class="col-3"><strong>會員圖片</strong></div>
				<div class="col-2"><strong>帳號</strong></div>
				<div class="col-2"><strong>電話</strong></div>
				<div class="col-2"><strong>名稱</strong></div>
				<div class="col-2"><strong>狀態</strong></div>
				<div class="col-1"><strong>訂單</strong></div>
			</li>
		`);

		members.forEach(item => {
			$("#list").append(
				MemberViewModel.getManagerView(item.userID, item.userPhone, item.userName, item.userStatus)
			);

			$(`#btnShowOrder${item.userID}`).click(() => {
				if ($(`#orders${item.userID}`).html().trim().length <= 0) {
					showOrder(item.userID);
				} else {
					$(`#orders${item.userID}`).empty();
				}

			});

		});
	}
	function showOrder(userID) {
		$(`#orders${userID}`).empty();
		$(`#orders${userID}`).html(`
			<li class="row">
				<div class="col-4"><strong>訂單編號</strong></div>
				<div class="col-4"><strong>日期</strong></div>
				<div class="col-2"><strong>總價</strong></div>
				<div class="col-2"></div>
			</li>
		`);
		orders.forEach(element => {
			if (element.userId != userID) {
				return;
			}
			$(`#orders${userID}`).append(
				OrderViewModel.getOrderView(element.orderID, element.orderDate, element.total)
			);

			$(`#aOrder${element.orderID}`).click(function () {
				element.attention = !element.attention;
				orderDetailLayout(element);
			});
		});
	}

	//訂單明細生成
	function orderDetailLayout(order) {
		let id = order.orderID;
		if (!order.attention) {
			$(`#orderDetails${id}`).empty();
			return;
		}
		$(`#orderDetails${id}`).html(`
				<li class="row">
					<div class="col-3">訂單明細</div>
					<div class="col-3">商品名稱</div>
					<div class="col-3">購買價格</div>
					<div class="col-3">購買數量</div>
				</li><br>
			`);
		//此預計在另外做伺服請求
		for (let item of orderDetails) {
			if (item.orderID != id) {
				continue;
			}
			$(`#orderDetails${id}`)
				.append(OrderViewModel.getDetailsView(item.commodityNane,
					item.orderCommodityPrice, item.orderCommodityQuantity));
		}
	}
	$(window).ready(() => {
		updateMenu();
	});
</script>

</html>